{"Outputs":{"ApiUrl":{"Value":{"Fn::GetAtt":["HttpApiF5A9A8A7","ApiEndpoint"]}},"CloudFrontUrl":{"Value":{"Fn::GetAtt":["CloudFrontDistributionBA64CE3A","DomainName"]}}},"Parameters":{"BootstrapVersion":{"Default":"/cdk-bootstrap/hnb659fds/version","Description":"Version of the CDK Bootstrap resources in this environment, automatically retrieved from SSM Parameter Store. [cdk:skip]","Type":"AWS::SSM::Parameter::Value\u003cString\u003e"}},"Resources":{"CloudFrontDistributionBA64CE3A":{"Properties":{"DistributionConfig":{"Comment":"Dynamic Image Generator CDK Stack","DefaultCacheBehavior":{"CachePolicyId":{"Ref":"CustomCachePolicyB899BAE1"},"Compress":true,"TargetOriginId":"TestCdkStackCloudFrontDistributionOrigin1E7CEA5AD","ViewerProtocolPolicy":"redirect-to-https"},"Enabled":true,"HttpVersion":"http2","IPV6Enabled":true,"Logging":{"Bucket":{"Fn::GetAtt":["LogBucketCC3B17E8","RegionalDomainName"]}},"Origins":[{"CustomOriginConfig":{"OriginProtocolPolicy":"https-only","OriginSSLProtocols":["TLSv1.2"]},"DomainName":{"Fn::Select":[2,{"Fn::Split":["/",{"Fn::GetAtt":["HttpApiF5A9A8A7","ApiEndpoint"]}]}]},"Id":"TestCdkStackCloudFrontDistributionOrigin1E7CEA5AD"}]}},"Type":"AWS::CloudFront::Distribution"},"CustomCachePolicyB899BAE1":{"Properties":{"CachePolicyConfig":{"Comment":"Dynamic Image Generator CDK Stack","DefaultTTL":60,"MaxTTL":300,"MinTTL":10,"Name":"DynamicImageCachePolicy","ParametersInCacheKeyAndForwardedToOrigin":{"CookiesConfig":{"CookieBehavior":"none"},"EnableAcceptEncodingBrotli":false,"EnableAcceptEncodingGzip":false,"HeadersConfig":{"HeaderBehavior":"none"},"QueryStringsConfig":{"QueryStringBehavior":"all"}}}},"Type":"AWS::CloudFront::CachePolicy"},"ECRLambdaFunctionBCD1BB9C":{"DependsOn":["ECRLambdaFunctionServiceRoleBA917E44"],"Properties":{"Code":{"ImageUri":{"Fn::Join":["",[{"Ref":"AWS::AccountId"},".dkr.ecr.",{"Ref":"AWS::Region"},".",{"Ref":"AWS::URLSuffix"},"/d-img-gen-demo:latest"]]}},"Description":"Dynamic Image Generator CDK Stack","EphemeralStorage":{"Size":1024},"FunctionName":"dynamic-image-lambda","MemorySize":1024,"PackageType":"Image","Role":{"Fn::GetAtt":["ECRLambdaFunctionServiceRoleBA917E44","Arn"]},"Timeout":30},"Type":"AWS::Lambda::Function"},"ECRLambdaFunctionServiceRoleBA917E44":{"Properties":{"AssumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"ManagedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]},"Type":"AWS::IAM::Role"},"HttpApiANYproxy435A1FB9":{"Properties":{"ApiId":{"Ref":"HttpApiF5A9A8A7"},"AuthorizationType":"NONE","RouteKey":"ANY /{proxy+}","Target":{"Fn::Join":["",["integrations/",{"Ref":"HttpApiANYproxyLambdaIntegration6181A2F1"}]]}},"Type":"AWS::ApiGatewayV2::Route"},"HttpApiANYproxyLambdaIntegration6181A2F1":{"Properties":{"ApiId":{"Ref":"HttpApiF5A9A8A7"},"IntegrationType":"AWS_PROXY","IntegrationUri":{"Fn::GetAtt":["ECRLambdaFunctionBCD1BB9C","Arn"]},"PayloadFormatVersion":"2.0"},"Type":"AWS::ApiGatewayV2::Integration"},"HttpApiANYproxyLambdaIntegrationPermission2EDD6285":{"Properties":{"Action":"lambda:InvokeFunction","FunctionName":{"Fn::GetAtt":["ECRLambdaFunctionBCD1BB9C","Arn"]},"Principal":"apigateway.amazonaws.com","SourceArn":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":execute-api:",{"Ref":"AWS::Region"},":",{"Ref":"AWS::AccountId"},":",{"Ref":"HttpApiF5A9A8A7"},"/*/*/{proxy+}"]]}},"Type":"AWS::Lambda::Permission"},"HttpApiDefaultStage3EEB07D6":{"Properties":{"ApiId":{"Ref":"HttpApiF5A9A8A7"},"AutoDeploy":true,"StageName":"$default"},"Type":"AWS::ApiGatewayV2::Stage"},"HttpApiF5A9A8A7":{"Properties":{"Description":"Dynamic Image Generator CDK Stack","Name":"dynamic-image-api","ProtocolType":"HTTP"},"Type":"AWS::ApiGatewayV2::Api"},"LogBucketCC3B17E8":{"DeletionPolicy":"Retain","Properties":{"OwnershipControls":{"Rules":[{"ObjectOwnership":"BucketOwnerPreferred"}]}},"Type":"AWS::S3::Bucket","UpdateReplacePolicy":"Retain"}},"Rules":{"CheckBootstrapVersion":{"Assertions":[{"Assert":{"Fn::Not":[{"Fn::Contains":[["1","2","3","4","5"],{"Ref":"BootstrapVersion"}]}]},"AssertDescription":"CDK bootstrap stack version 6 required. Please run 'cdk bootstrap' with a recent version of the CDK CLI."}]}}}